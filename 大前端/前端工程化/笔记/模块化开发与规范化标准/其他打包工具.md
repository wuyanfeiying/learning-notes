<!--
 * @Date: 2021-08-16 21:48:46
 * @LastEditors: chuhongguang
-->
[TOC]
#### Rollup 概述
- Rollup 是一款 ESM的打包器，可以将项目中散落的细小模块，打包成整块的代码，从而使划分的模块更好的分布到浏览器环境或者nodeJS环境。
- 和 webpack相比，Rollup 更为小巧，仅仅是一款ESM打包器。例如：Rollup 中并不支持类似 HMR这种高级特性。
- Rollup 初衷是提供一个充分利用 ESM 各项特性的高效打包器。

##### Rollup 快速上手
`yarn add rollup --dev`
运行: 直接允许 yarn XXX 会找到对应插件的 cli 入口
`yarn rollup ./src/index.js --format iife --file dist.bundle.js`
指定格式，浏览器支持的自调用函数的格式
`--format iife`
指定输入的文件
`--file dist.bundle.js`

##### Rollup 配置文件
在项目中新建配置文件： `rollup.config.js`

```js
export default {
  // 指定打包文件入口
  input: 'src/index.js',
  // 指定输出的相关配置
  output: {
    file: 'dist/bundle.js', // 输出文件名
    format: 'iife', // 输出格式
  }
}
```
运行
`yarn rollup --config`

##### Rollup 使用插件
1. 加载其他类型的资源文件
2. 导入 CommonJS 模块
3. 编译 ECMAScript 新特性

以上需求， Rollup 支持使用插件的方式扩展。
插件是  Rollup 唯一的扩展途径。

- 例子：rollup-plugin-json
安装插件：
`yarn add rollup-plugin-json --dev`

在项目中新建配置文件： `rollup.config.js`

```js
import json from 'rollup.config.js'

export default {
  ...,
  plugins: [
    json() // 注意这里是结果
  ]
}
```

##### Rollup 加载 NPM 模块
rollup-plugin-node-resolve
```js
import resolve from 'rollup-plugin-node-resolve'

export default {
  ...,
  plugins: [
    resolve()
  ]
}
```

##### Rollup 加载 CommonJS 模块
默认不支持 加载 CommonJS 模块，可以使用插件 rollup-plugin-commonjs
```js
import commonjs from 'rollup-plugin-commonjs'

export default {
  ...,
  plugins: [
    commonjs()
  ]
}
```